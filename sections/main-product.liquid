{% assign current_variant = product.selected_or_first_available_variant %}

<script>
window.variants = {{ product.variants | json }};
window.formatMoney = function(cents) {
  return (cents/100).toLocaleString('en-US', {
    style: 'currency',
    currency: '{{ shop.currency }}'
  });
}
</script>

[Previous content unchanged until function handleVariantChange]

function handleVariantChange(event) {
  const select = event.target;
  const form = select.closest('form');
  const selects = form.querySelectorAll('select');
  const selectedOptions = Array.from(selects).map(select => select.value);
  
  const matchingVariant = window.variants.find(variant => 
    variant.options.every((option, index) => option === selectedOptions[index])
  );
  
  if (matchingVariant) {
    // Update variant ID
    document.getElementById('variant-id').value = matchingVariant.id;
    
    // Update price
    const priceElement = form.closest('.mt-10').querySelector('.text-3xl.tracking-tight');
    if (priceElement) {
      priceElement.textContent = window.formatMoney(matchingVariant.price);
    }
    
    // Update button state
    [Rest of button state code unchanged]
    
    // Update variant image
    [Rest of image update code unchanged]
  }
}